# content of: tox.ini , put in same dir as setup.py
[tox]
envlist=flake8,py27,validate

[testenv:py27]
deps =
    -rdev-requirements.txt
    -rtest-requirements.txt
commands =
    nosetests -v --cover-html --with-coverage \
        --cover-package=cloudify_cloudinit \
        --cover-package=cloudify_deployment_proxy \
        --cover-package=cloudify_ssh_key \
        --cover-package=cloudify_configuration \
        --cover-package=cloudify_terminal \
        --cover-package=cloudify_files \
        --with-xunit --xunit-file=nosetests.xml .

[testenv:flake8]
deps =
    -rdev-requirements.txt
    -rtest-requirements.txt
commands =
    flake8 cloudify_cloudinit
    flake8 cloudify_deployment_proxy
    flake8 cloudify_ssh_key
    flake8 cloudify_configuration
    flake8 cloudify_terminal
    flake8 cloudify_files
    pylint -E cloudify_deployment_proxy \
           -E cloudify_ssh_key \
           -E cloudify_terminal \
           -E cloudify_configuration \
           -E cloudify_files

[testenv:validate]
deps =
    -rdev-requirements.txt
    -rtest-requirements.txt
commands =
    # configration plugin
    cfy blueprint validate cloudify_cloudinit/examples/simple.yaml
    # configration plugin
    cfy blueprint validate cloudify_configuration/examples/simple.yaml
    # deployment proxy examples
    cfy blueprint validate cloudify_deployment_proxy/examples/deployment-proxy.yaml
    cfy blueprint validate cloudify_deployment_proxy/examples/deployment-proxy-reuse.yaml
    cfy blueprint validate cloudify_deployment_proxy/examples/deployment-proxy-custom-workflow.yaml
    cfy blueprint validate cloudify_deployment_proxy/examples/deployment-without-workflow.yaml
    cfy blueprint validate cloudify_deployment_proxy/examples/node-instance-proxy.yaml
    # ssh examples
    cfy blueprint validate cloudify_ssh_key/examples/import-simple-manager.yaml
    cfy blueprint validate cloudify_ssh_key/examples/ssh-key-blueprint.yaml
    # too slow
    # cfy blueprint validate cloudify_ssh_key/examples/azure-blueprint.yaml
    # uncomment after release
    # terminal examples
    cfy blueprint validate cloudify_terminal/examples/fortigate.yaml
    cfy blueprint validate cloudify_terminal/examples/cisco.yaml
    cfy blueprint validate cloudify_terminal/examples/linux-ssh.yaml
